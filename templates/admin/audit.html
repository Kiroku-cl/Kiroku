{% extends "base.html" %}

{% block title %}Admin Auditoría - HILO{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="admin-header">
        <div>
            <h1 class="admin-title">Auditoría</h1>
            <div class="admin-subtitle">Eventos y trazabilidad</div>
        </div>
    </div>

    {% include "admin/partials/nav.html" %}

    <div class="admin-header" style="margin-bottom: 16px;">
        <button type="button" class="btn btn-action danger" id="clear-logs">Borrar logs</button>
        <button type="button" class="btn btn-action" id="cleanup-events">Limpiar eventos (90 días)</button>
    </div>

    <div class="admin-panel">
        <table class="admin-table" id="audit-table">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Acción</th>
                    <th>Actor</th>
                    <th>Target</th>
                    <th>Detalles</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<div class="toast-container" id="toast-container"></div>

<div id="audit-detail-modal" class="modal-overlay" style="display: none;">
    <div class="modal-card modal-json-card">
        <h3>Detalles</h3>
        <pre class="json-pre"><code id="audit-detail-code" class="language-json"></code></pre>
        <div class="modal-actions">
            <button class="btn btn-secondary" id="audit-detail-close">Cerrar</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="{{ url_for('static', filename='dist/admin.min.js') }}" type="module"></script>
{% endblock %}
